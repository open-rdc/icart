<?xml version="1.0"?>

<launch>
  <arg name="scan_frame" default="/hokuyo_link"/>
  <!--arg name="scan_dev" default="/dev/sensors/hokuyo_urg"/-->
  <!--arg name="imu_dev" default="/dev/sensors/imu"/-->

  <!--Select the device name by the robot-->
  <arg name="sensor_dev" default="$(find icart_mini_dirver)/launch/icart_mini_dev.launch"/>
  <include file="$(arg sensor_dev)"/>
  
  <node name="ypspur_coordinator_bridge" pkg="icart_mini_driver" type="ypspur_coordinator_bridge"/>
 
  <param name="robot_description"
         command="$(find xacro)/xacro.py '$(find icart_mini_description)/urdf/icart_mini.xacro'" />
  
  <node pkg="hokuyo_node" type="hokuyo_node" name="hokuyo_node">
    <param name="frame_id" value="$(arg scan_frame)"/>
    <param name="port" value="$(arg scan_dev)"/>
  </node>

  <node pkg="imu" type="imu" name="imu">
    <param name="port_name" value="$(arg imu_dev)"/>
    <param name="z_axis_dir" value="-1"/>
  </node>

  <node name="icart_mini_driver_node" pkg="icart_mini_driver" output="screen" type="icart_mini_driver_node"/>
  
  <node name="combine_dr_measurements" pkg="combine_dr_measurements" type="odometry_publisher">
    <param name="max_update_rate" value="80"/>
    <remap from="odom" to="/icart_mini/odom"/>
    <remap from="imu" to="imu"/>
  </node>

  <include file="$(find icart_mini_control)/launch/icart_mini_control.launch" />
  
</launch>
